{"ast":null,"code":"import _regeneratorRuntime from\"/Users/achay/Desktop/hackathon/react-firebase-chat/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/achay/Desktop/hackathon/react-firebase-chat/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/achay/Desktop/hackathon/react-firebase-chat/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useRef,useState,useEffect}from'react';import'./App.css';import axios from'axios';import firebase from'firebase/app';import'firebase/firestore';import'firebase/auth';import'firebase/analytics';import{useAuthState}from'react-firebase-hooks/auth';import{useCollectionData}from'react-firebase-hooks/firestore';firebase.initializeApp({apiKey:\"AIzaSyDcq-WCSuwM-m2Cay6cfqjKDEj7S2O-Py8\",authDomain:\"hackathon-906bf.firebaseapp.com\",projectId:\"hackathon-906bf\",storageBucket:\"hackathon-906bf.appspot.com\",messagingSenderId:\"637654124074\",appId:\"1:637654124074:web:1c385fc0258eca67fca553\",measurementId:\"G-C33WRXMYBB\"});var auth=firebase.auth();var firestore=firebase.firestore();var analytics=firebase.analytics();function App(){var _useAuthState=useAuthState(auth),_useAuthState2=_slicedToArray(_useAuthState,1),user=_useAuthState2[0];return/*#__PURE__*/React.createElement(\"div\",{className:\"App\"},/*#__PURE__*/React.createElement(\"header\",null,/*#__PURE__*/React.createElement(\"h1\",null,\"\\uD83D\\uDCAC SEP TEAM 1\"),/*#__PURE__*/React.createElement(SignOut,null)),/*#__PURE__*/React.createElement(\"section\",null,user?/*#__PURE__*/React.createElement(ChatRoom,null):/*#__PURE__*/React.createElement(SignIn,null)));}function SignIn(){var signInWithGoogle=function signInWithGoogle(){var provider=new firebase.auth.GoogleAuthProvider();auth.signInWithPopup(provider);};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"button\",{className:\"sign-in\",onClick:signInWithGoogle},\"Sign in with Google\"));}function SignOut(){return auth.currentUser&&/*#__PURE__*/React.createElement(\"button\",{className:\"sign-out\",onClick:function onClick(){return auth.signOut();}},\"Sign Out\");}function ChatRoom(){var dummy=useRef();var messagesRef=firestore.collection('messages');var query=messagesRef.orderBy('createdAt').limit(25);var _useCollectionData=useCollectionData(query,{idField:'id'}),_useCollectionData2=_slicedToArray(_useCollectionData,1),messages=_useCollectionData2[0];var _useState=useState(''),_useState2=_slicedToArray(_useState,2),formValue=_useState2[0],setFormValue=_useState2[1];var sendMessage=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var _auth$currentUser,uid,photoURL,displayName,response,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_auth$currentUser=auth.currentUser,uid=_auth$currentUser.uid,photoURL=_auth$currentUser.photoURL,displayName=_auth$currentUser.displayName;_context.next=4;return axios.post('https://d1zqqz8u9h.execute-api.us-east-1.amazonaws.com/prod',{inputTranscript:formValue},{headers:{'Content-Type':'application/json'}});case 4:response=_context.sent;data=JSON.parse(response.data.body);_context.next=8;return messagesRef.add({displayName:displayName,text:formValue,createdAt:firebase.firestore.FieldValue.serverTimestamp(),uid:uid,photoURL:photoURL,sentiment:data['sentiment']});case 8:setFormValue('');dummy.current.scrollIntoView({behavior:'smooth'});case 10:case\"end\":return _context.stop();}}},_callee);}));return function sendMessage(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"main\",null,messages&&messages.map(function(msg){return/*#__PURE__*/React.createElement(ChatMessage,{key:msg.id,message:msg});}),/*#__PURE__*/React.createElement(\"span\",{ref:dummy})),/*#__PURE__*/React.createElement(\"form\",{onSubmit:sendMessage},/*#__PURE__*/React.createElement(\"input\",{value:formValue,onChange:function onChange(e){return setFormValue(e.target.value);},placeholder:\"say something nice\"}),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",disabled:!formValue},\"\\uD83D\\uDE80\")));}function ChatMessage(props){var _props$message=props.message,text=_props$message.text,uid=_props$message.uid,photoURL=_props$message.photoURL,displayName=_props$message.displayName,sentiment=_props$message.sentiment;var result;if(sentiment===\"NEUTRAL\"){result=/*#__PURE__*/React.createElement(\"span\",{className:\"sentiment\"},displayName,\" seems \\uD83D\\uDE10\");}if(sentiment===\"POSITIVE\"){result=/*#__PURE__*/React.createElement(\"span\",{className:\"sentiment\"},displayName,\" seems \\uD83D\\uDE00\");}if(sentiment===\"NEGATIVE\"){result=/*#__PURE__*/React.createElement(\"span\",{className:\"sentiment\"},displayName,\" seems \\uD83D\\uDE21\");}var messageClass=uid===auth.currentUser.uid?'sent':'received';return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"message \".concat(messageClass)},/*#__PURE__*/React.createElement(\"img\",{src:photoURL||'https://api.adorable.io/avatars/23/abott@adorable.png'}),/*#__PURE__*/React.createElement(\"p\",null,text),result));}export default App;","map":{"version":3,"sources":["/Users/achay/Desktop/hackathon/react-firebase-chat/src/App.js"],"names":["React","useRef","useState","useEffect","axios","firebase","useAuthState","useCollectionData","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","auth","firestore","analytics","App","user","SignIn","signInWithGoogle","provider","GoogleAuthProvider","signInWithPopup","SignOut","currentUser","signOut","ChatRoom","dummy","messagesRef","collection","query","orderBy","limit","idField","messages","formValue","setFormValue","sendMessage","e","preventDefault","uid","photoURL","displayName","post","inputTranscript","headers","response","data","JSON","parse","body","add","text","createdAt","FieldValue","serverTimestamp","sentiment","current","scrollIntoView","behavior","map","msg","id","target","value","ChatMessage","props","message","result","messageClass"],"mappings":"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","sourcesContent":["import React, { useRef, useState, useEffect} from 'react';\nimport './App.css';\nimport axios from 'axios'\nimport firebase from 'firebase/app';\nimport 'firebase/firestore';\nimport 'firebase/auth';\nimport 'firebase/analytics';\n\n\n\nimport { useAuthState } from 'react-firebase-hooks/auth';\nimport { useCollectionData } from 'react-firebase-hooks/firestore';\n\nfirebase.initializeApp({\n  apiKey: \"AIzaSyDcq-WCSuwM-m2Cay6cfqjKDEj7S2O-Py8\",\n  authDomain: \"hackathon-906bf.firebaseapp.com\",\n  projectId: \"hackathon-906bf\",\n  storageBucket: \"hackathon-906bf.appspot.com\",\n  messagingSenderId: \"637654124074\",\n  appId: \"1:637654124074:web:1c385fc0258eca67fca553\",\n  measurementId: \"G-C33WRXMYBB\"\n})\n\n\nconst auth = firebase.auth();\nconst firestore = firebase.firestore();\nconst analytics = firebase.analytics();\n\n\nfunction App() {\n\n  const [user] = useAuthState(auth);\n\n  return (\n    <div className=\"App\">\n      <header>\n        {/* <h1>⚛️🔥💬</h1> */}\n        <h1>💬 SEP TEAM 1</h1>\n        <SignOut />\n      </header>\n\n      <section>\n        {user ? <ChatRoom /> : <SignIn />}\n      </section>\n\n    </div>\n  );\n}\n\nfunction SignIn() {\n\n  const signInWithGoogle = () => {\n    const provider = new firebase.auth.GoogleAuthProvider();\n    auth.signInWithPopup(provider);\n  }\n\n  return (\n    <>\n      <button className=\"sign-in\" onClick={signInWithGoogle}>Sign in with Google</button>\n    </>\n  )\n\n}\n\nfunction SignOut() {\n  return auth.currentUser && (\n    <button className=\"sign-out\" onClick={() => auth.signOut()}>Sign Out</button>\n  )\n}\n\n\nfunction ChatRoom() {\n  const dummy = useRef();\n  const messagesRef = firestore.collection('messages');\n  const query = messagesRef.orderBy('createdAt').limit(25);\n\n  const [messages] = useCollectionData(query, { idField: 'id' });\n\n  const [formValue, setFormValue] = useState('');\n\n\n  const sendMessage = async (e) => {\n    e.preventDefault();\n\n    const { uid, photoURL, displayName} = auth.currentUser;\n\n    const response = await axios.post('https://d1zqqz8u9h.execute-api.us-east-1.amazonaws.com/prod', {inputTranscript : formValue}, {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    })\n\n    const data = JSON.parse(response.data.body)\n\n    await messagesRef.add({\n      displayName : displayName,\n      text: formValue,\n      createdAt: firebase.firestore.FieldValue.serverTimestamp(),\n      uid,\n      photoURL,\n      sentiment : data['sentiment']\n    })\n\n    setFormValue('');\n    dummy.current.scrollIntoView({ behavior: 'smooth' });\n  }\n\n  return (<>\n    <main>\n\n      {messages && messages.map(msg => <ChatMessage key={msg.id} message={msg} />)}\n\n      <span ref={dummy}></span>\n\n    </main>\n\n    <form onSubmit={sendMessage}>\n\n      <input value={formValue} onChange={(e) => setFormValue(e.target.value)} placeholder=\"say something nice\" />\n\n      <button type=\"submit\" disabled={!formValue}>🚀</button>\n\n    </form>\n  </>)\n}\n\n\nfunction ChatMessage(props) {\n  const { text, uid, photoURL, displayName, sentiment } = props.message;\n  let result ;\n  if (sentiment === \"NEUTRAL\"){ result = <span className='sentiment'>{displayName} seems 😐</span>}\n  if (sentiment === \"POSITIVE\"){ result = <span className='sentiment'>{displayName} seems 😀</span>}\n  if (sentiment === \"NEGATIVE\"){ result = <span className='sentiment'>{displayName} seems 😡</span>}\n\n\n  const messageClass = uid === auth.currentUser.uid ? 'sent' : 'received';\n\n  return (<>\n        <div className={`message ${messageClass}`}>\n          <img src={photoURL || 'https://api.adorable.io/avatars/23/abott@adorable.png'} />\n          <p>{text}</p>\n          {result}\n        </div>\n  </>)\n}\n\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}